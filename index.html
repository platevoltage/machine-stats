<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <canvas id="canvas" width="100" height="100"></canvas>
    <script>
        var canvas = document.getElementById('canvas');
        // const ctx = canvas.getContext('2d') as CanvasRenderingContext2D;
        // ctx.imageSmoothingQuality = 'high';
        canvas.width = 100;
        canvas.height = 20;
        console.log(window)
        window.api.getData((event, data) => {
            
            window.api.sendGraph( drawGraph(data) );
            console.log(data)
          });   

        function drawGraph(data) {
            // console.log(data);
            canvas.width = data.PerCore?.length * 5 || 50;
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height)
            for (let i in data.PerCore) {
              console.log(i);
              ctx.fillStyle = 'red';
              ctx.fillRect(i*5, canvas.height, 4, -(+data.PerCore[i].utilization ?? 0)/2)
            }
            
            return canvas.toDataURL('image/png', 1);
          }


    </script>

</body>
</html>